%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% standard header
    \documentclass[12pt,fleqn]{article}
    \usepackage[top=2cm,bottom=2cm,left=2cm,right=2cm]{geometry}
    \usepackage[utf8x]{inputenc}
    \usepackage{titlesec} % see below
    \usepackage{xcolor} % \color \textcolor
    \usepackage{hyperref} % \href
    \usepackage[normalem]{ulem} % normalem retains \emph as italic
    % \uline \uuline \uwave \sout
    \usepackage{enumitem}
    % \begin{enumerate}[label=\Alpha*.]
    % \begin{enumerate}[label=\(\bullet\)]
    \usepackage{graphicx}
    % \includegraphicswidth=0.5\textwidth,trim=[0cm 0cm 0cm 0cm,clip]{file.png}
    \usepackage{pdfpages} % \includepdf[pages=1]{file.pdf}
    % for prose
    %\usepackage[doublespacing]{setspace}
    \usepackage{csquotes} % \blockquote
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \renewcommand{\rmdefault}{cmr}
    \renewcommand{\sfdefault}{cmss}
    \renewcommand{\ttdefault}{cmtt}
    \renewcommand{\familydefault}{\rmdefault}
    \setlength{\titlewidth}{\textwidth}

    \titlespacing{\section}{0pt}{0pt}{0pt}
    \titlespacing{\subsection}{0pt}{0pt}{0pt}
    \titlespacing{\subsubsection}{0pt}{0pt}{0pt}
    \titlespacing{\paragraph}{0pt}{0pt}{0pt}
    % https://www.overleaf.com/learn/latex/How_to_write_a_LaTeX_class_file_and_design_your_own_CV_(Part_1)
    % \titleformat{command}[shape]{format}{label}{sep}{before-code}[after-code]
    \titleformat{\section}         % Customise the \section command 
        [hang]
        {\Large\ttfamily\raggedright} % Make the \section headers large (\Large),
                                   % small capitals (\scshape) and left aligned (\raggedright)
        {}{0em}                      % Can be used to give a prefix to all sections, like 'Section ...'
        {}                           % Can be used to insert code before the heading
        [\titlerule]                 % Inserts a horizontal line after the heading
    \titleformat{\subsection}
        [hang]
        {\large\ttfamily\raggedright}
        {}{0em}
        {}
        []
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% packages
    \usepackage{hejohns-hazel}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% get rid of 10-modules stuff
    \renewcommand*{\TypVarCtx}{\Phi}
    \renewcommand*{\ModVarCtx}{}
    \renewcommand*{\SigVarCtx}[1][]{}
% misc
    \newcommand*{\AlgConsistentSubKindOp}{%
        \begin{tikzpicture}[scale=0.5, baseline=-1.5mm, thick]
        \node(triangle) at (-0.3mm, 0){\Large$\triangleleft$};
        \node(sim) at (0, -4.5mm){$\sim$};
        \end{tikzpicture}%
    }
    \newcommand*{\AlgTypeEquivOp}{%
        \begin{tikzpicture}[scale=0.5, baseline=-1.2mm, thick]
        \node(equiv) at (0, 0){$\equiv$};
        \node(lb) at (-5mm, .1mm){$<$};
        \node(rb) at (5mm, .1mm){$>$};
        \end{tikzpicture}%
    }
\pagenumbering{gobble}
\nonfrenchspacing
%\frenchspacing % when monospaced
\begin{document}
\title{Hazel MetaPhi: 9-type-aliases}
\author{}
\date{\today}
\maketitle
\section{introduction}
    \subsection*{}
    f
\section{Issues}
    \subsection*{}
    \begin{enumerate}[label=Issue \arabic*:]
        \item Algorithmic rules are not ``officially" algorithmic \\
            Since we are going all out to Do It Rightâ„¢, it should be noted that the declarative/algorithmic bifurcation is not complete with $\KndAsc$ ($\WellFormedAtKind{\typ}$). \\
            For example, kind analysis is premissed on $\ConsistentSubKindOp$ ($\ConsistentSubKind{\knd[_1]}{\knd[_2]}$) at \texttt{KAASubsume},
            which is itself premissed on $\TypeEquivOp$ ($\TypeEquiv{\typ[_1]}{\typ[_2]}[]$) at \texttt{KCRespectEquiv},
            which is itself premissed on $\KndAsc$ ($\WellFormedAtKind{\typ}$) at \texttt{KCESingEquiv}. \\
            Explicitly algorithmic counterparts to $\ConsistentSubKindOp$ and $\TypeEquivOp$ need to be defined.
            Suggested notation: $\AlgConsistentSubKindOp$ and $\AlgTypeEquivOp$ (faintly reminiscent of Stone and Harper).
        \item A $\typvar\KndAssump\knd\in\TypVarCtx \implies \typvar\KndAsc\SKind{\typvar}$ (like) rule is problematic \\
            When $\forall \typ.\WellFormedAtKind{\typ}\implies \WellFormedAtKind{\typ}[\Type]$, as is now,
            this is fine (except for improperly (non)contexted holes $\forall \typ.\WellFormedAtKind[]{\typ}[\Type]$ I would think).
            But in the presence of non$\Type$ kinds, this rule no longer conveys the correct meaning (intuitively speaking).
            For example, if we redefined $\greentt{list(\typ)}$ to be a type constructor proper instead of a builtin type schema,
            such that $\WellFormedAtKind[]{\greentt{list}}[\Type \red{\rightarrow} \Type]$,
            and had nonstifled type aliases such that $\typvar\KndAssump\greentt{list}$, $\SKind{\typvar}$ certainly does not mean what we want
            (I say nonstifled since we could technically skirt this issue by demanding type alias definitions to be a $\Type$,
            but that would clearly be stifling-- and no langauge does this for obvious reasons). \\
            So the logical conclusion is higher order singletons.
            Thankfully, Stone and Harper showed that HOSingletons are definable in terms of ``vanilla" singletons.
            Thus, we do not need to add HOSingletons to the object language itself-- only to the metalangauge.
            HOSingletons should make the metatheory proofs more general.
            The question is how HOSingletons and holes should interact.
    \end{enumerate}
\section{Not Issues-- but worth mentioning}
    \subsection*{}
    \begin{enumerate}[label=Nibwm \arabic*:]
        \item In the presence of higher order types/type constructors, there exists a more nuanced notion of type equivalence (extensionality) in which equivalence depends on the kind at which the types are compared \\
            Without ``real" subkinding, examples are a bit more contrived. \\
            From Stone and Harper (2006): \\
            \[
                \TypeEquiv[]{\TypCFun{\typvar\KndAsc\Type}{\typvar}}{\TypCFun{\typvar\KndAsc\Type}{\Int}}[\SKind{\Int} \red{\rightarrow} \Type]
            \]
            should be derivable but
            \[
                \TypeEquiv[]{\TypCFun{\typvar\KndAsc\Type}{\typvar}}{\TypCFun{\typvar\KndAsc\Type}{\Int}}[\Type \red{\rightarrow} \Type]
            \]
            should not, where $\ConsistentSubKind[]{\red{\Type \rightarrow \Type}}{\red{\SKind{\Int} \rightarrow \Type}}$ \\
            Interestingly
            \[
                \TypeEquiv[]{\TypCFun{\typvar\KndAsc\Type}{\typvar}}{\TypCFun{\typvar\KndAsc\Type}{\Int}}[\SKind{\Int} \red{\rightarrow} \SKind{\Int}]
            \]
            should also be derivable, where $\ConsistentSubKind[]{\SKind{\Int} \red{\rightarrow} \SKind{\Int}}{\SKind{\Int} \red{\rightarrow} \Type}$ \\
            With ``real" subkinding, this behavior is more serious. \\
            From Aspinall (1995), using singleton types and $\mathtt{Nat \le Int}$ (``real" subtyping):
            \[
                \TypeEquiv[]{\bluett{\lambda x\TypAsc Int.if~x \ge 0~then~x~else~2*x}}{\bluett{\lambda x\TypAsc Int.x}}[\greentt{Nat \rightarrow Int}]
            \]
            should be derivable but
            \[
                \TypeEquiv[]{\bluett{\lambda x\TypAsc Int.if~x \ge 0~then~x~else~2*x}}{\bluett{\lambda x\TypAsc Int.x}}[\greentt{Int \rightarrow Int}]
            \]
            should not. \\
            I do not believe this more nuanced view of equality buys anything for us.
    \end{enumerate}
\newpage
    \includepdf[scale=0.9,pages=1,pagecommand={\section{Attachments}\subsection*{9-type-aliases marked up with preliminary declarative statics notes}Attachment 1}, offset=0 -2cm]{kind_judgements_statics.pdf}
    \includepdf[scale=0.9,pages=2-,pagecommand={Attachment 1}]{kind_judgements_statics.pdf}
\end{document}
